<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="SSMT3.GameTypePage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:SSMT3"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    xmlns:community="using:CommunityToolkit.WinUI.UI.Controls"
    Background="Transparent"

    >
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
            
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="0.8*"/>
            <ColumnDefinition Width="auto"/>
        </Grid.ColumnDefinitions>

        <!-- 顶部菜单 -->
        <MenuBar 
            Grid.Row="0" 
            Grid.Column="0" 
            Margin="5">
            <MenuBarItem Title="文件" x:Name="Menu_File">
                <MenuFlyoutItem x:Name="Menu_ClearD3D11ElementList" Text="清空D3D11Element列表" Click="Menu_ClearD3D11ElementList_Click"/>
                <MenuFlyoutItem x:Name="Menu_SaveD3D11ElementList" Text="保存当前数据类型" Click="Menu_SaveD3D11ElementList_Click"/>
                <MenuFlyoutSeparator></MenuFlyoutSeparator>
                <MenuFlyoutItem x:Name="Menu_OpenGameTypeFolder" Text="打开数据类型文件夹" Click="Menu_OpenGameTypeFolder_Click"/>
                <MenuFlyoutItem x:Name="Menu_OpenGameTypeFile" Text="打开指定数据类型文件" Click="Menu_OpenGameTypeFile_Click"/>
            </MenuBarItem>
        </MenuBar>

        <ScrollViewer Grid.Column="0" Grid.Row="1" Margin="20">


            <StackPanel 
                Grid.Column="0"
                Grid.Row="1"
                Orientation="Vertical">

                <Expander
                    HorizontalContentAlignment="Stretch"
                    HorizontalAlignment="Stretch"
                    IsExpanded="True">
                    <Expander.Header>
                        <StackPanel Margin="10">
                            <TextBlock x:Name="TextBlock_SelectGameTypeTitle" Text="选择数据类型" FontSize="14" FontWeight="Bold" ToolTipService.ToolTip="在当前数据类型文件夹已存在的数据类型中选择一个，方便快速在已有的数据类型上进行修改新增来生成新的数据类型" />
                            <!--<TextBlock Text="在当前数据类型文件夹已存在的数据类型中选择一个，方便快速在已有的数据类型上进行修改新增来生成新的数据类型" 
                   FontSize="12" 
                   TextWrapping="Wrap"/>-->
                        </StackPanel>
                    </Expander.Header>

                    <ComboBox 
                        SelectionChanged="ComboBox_GameTypeNameList_SelectionChanged"
                        x:Name="ComboBox_GameTypeNameList"
                        MinWidth="600">
                    </ComboBox>

                </Expander>


                <Expander
                HorizontalContentAlignment="Stretch"
                HorizontalAlignment="Stretch"
                IsExpanded="True">
                    <Expander.Header>
                        <StackPanel Margin="10">
                            <TextBlock x:Name="TextBlock_D3D11ElementListTitle" Text="D3D11Element列表" FontSize="14" FontWeight="Bold" ToolTipService.ToolTip="有序的D3D11Element列表组成了一个完整的数据类型"/>
                            <!--<TextBlock Text="有序的D3D11Element列表组成了一个完整的数据类型" 
                   FontSize="12" 
                   TextWrapping="Wrap"/>-->
                        </StackPanel>
                    </Expander.Header>

                    <community:DataGrid 
                    MinHeight="400"
                    AutoGenerateColumns="False"  
                    Width="Auto"
                    x:Name="DataGrid_GameType"  
                    CellEditEnding="DataGrid_GameType_CellEditEnding"
                    >

                        <community:DataGrid.ContextFlyout>
                            <MenuFlyout>
                                <MenuFlyoutItem 
                                    x:Name="Menu_DeleteD3D11ElementLine" 
                                    Text="删除选中行" 
                                    Click="Menu_DeleteD3D11ElementLine_Click"/>

                                <MenuFlyoutItem
                                    x:Name="Menu_CopyLineToBottom"
                                    Text="复制此行内容并添加在最底部"
                                    Click="Menu_CopyLineToBottom_Click" />
                                
                                <MenuFlyoutItem
                                    x:Name="Menu_CopyLineToNext"
                                    Text="复制此行内容并添加在下一行"
                                    Click="Menu_CopyLineToNext_Click" />
                            </MenuFlyout>
                            
                        </community:DataGrid.ContextFlyout>


                        <community:DataGrid.Columns>
                            <community:DataGridTextColumn Header="SemanticName" Width="Auto" Binding="{Binding SemanticName}" IsReadOnly="False"/>
                            <community:DataGridTextColumn Header="Format"  Width="Auto" Binding="{Binding Format}" IsReadOnly="False"/>
                            <community:DataGridTextColumn Header="ExtractSlot"  Width="Auto" Binding="{Binding ExtractSlot}" IsReadOnly="False"/>
                            <community:DataGridTextColumn Header="ExtractTechnique"  Width="Auto" Binding="{Binding ExtractTechnique}" IsReadOnly="False"/>
                            <community:DataGridTextColumn Header="Category"  Width="Auto" Binding="{Binding Category}" IsReadOnly="False"/>
                            <community:DataGridTextColumn Header="DrawCategory"  Width="Auto" Binding="{Binding DrawCategory}" IsReadOnly="False"/>
                            <community:DataGridTextColumn Header="ByteWidth"  Width="Auto" Binding="{Binding ByteWidth}" IsReadOnly="False"/>
                        </community:DataGrid.Columns>
                    </community:DataGrid>
                </Expander>

            </StackPanel>



        </ScrollViewer>

        <ScrollViewer
                Grid.Column="1"
                Grid.Row="1">
                <StackPanel
                    Orientation="Vertical" 
                    Margin="20,20,20,20">
                    
                    

                    <StackPanel Orientation="Horizontal" Margin="5">
                        
                        <TextBlock x:Name="TextBlock_TotalStride"  ></TextBlock>
                    </StackPanel>

                    <Button 
                        Click="Button_RecalculateTotalStride_Click"
                        x:Name="Button_RecalculateTotalStride" 
                        Content="重新计算步长" 
                        VerticalAlignment="Center" 
                        Margin="5">
                    </Button>

                    <MenuFlyoutSeparator></MenuFlyoutSeparator>

                    <ComboBox 
                        Header="SemanticName"
                        x:Name="ComboBox_SemanticName" 
                        Width="200" 
                        Margin="5" 
                        IsEditable="True">
                        <ComboBoxItem>POSITION</ComboBoxItem>
                        <ComboBoxItem>NORMAL</ComboBoxItem>
                        <ComboBoxItem>TANGENT</ComboBoxItem>
                        <ComboBoxItem>BINORMAL</ComboBoxItem>
                        <ComboBoxItem>COLOR</ComboBoxItem>
                        <ComboBoxItem>TEXCOORD</ComboBoxItem>
                        <ComboBoxItem>BLENDWEIGHTS</ComboBoxItem>
                        <ComboBoxItem>BLENDINDICES</ComboBoxItem>
                    </ComboBox>

                    <!--Format的内容要根据当前选择的SemanticName来加载所有预制的可能结果-->
                    <ComboBox x:Name="ComboBox_Format" Header="Format" Width="200" Margin="5" IsEditable="True">
                        <ComboBoxItem>R32G32B32A32_FLOAT</ComboBoxItem>
                        <ComboBoxItem>R16G16B16A16_FLOAT</ComboBoxItem>
                        <ComboBoxItem>R16G16B16A16_UINT</ComboBoxItem>
                        <ComboBoxItem>R16G16B16A16_SNORM</ComboBoxItem>
                        <!--这里注意！一般是UINT，很少有游戏用到SINT-->
                        <ComboBoxItem>R32G32B32A32_UINT</ComboBoxItem>
                        <ComboBoxItem>R32G32B32A32_SINT</ComboBoxItem>
                        <ComboBoxItem>R32G32B32_FLOAT</ComboBoxItem>
                        <ComboBoxItem>R32G32_FLOAT</ComboBoxItem>
                        <ComboBoxItem>R32G32_UINT</ComboBoxItem>
                        <ComboBoxItem>R16G16_FLOAT</ComboBoxItem>
                        <ComboBoxItem>R16G16_UINT</ComboBoxItem>
                        <ComboBoxItem>R32_FLOAT</ComboBoxItem>
                        <ComboBoxItem>R32_UINT</ComboBoxItem>
                        <ComboBoxItem>R8G8B8A8_UNORM</ComboBoxItem>
                        <ComboBoxItem>R8G8B8A8_SNORM</ComboBoxItem>
                        <ComboBoxItem>R8G8B8A8_UINT</ComboBoxItem>
                    </ComboBox>

                    <ComboBox 
                        Header="ExtractSlot"
                        x:Name="ComboBox_ExtractSlot" 
                        Width="200" 
                        Margin="5" 
                        IsEditable="True">
                        <ComboBoxItem>vb0</ComboBoxItem>
                        <ComboBoxItem>vb1</ComboBoxItem>
                        <ComboBoxItem>vb2</ComboBoxItem>
                        <ComboBoxItem>vb3</ComboBoxItem>
                        <ComboBoxItem>vb4</ComboBoxItem>
                        <ComboBoxItem>vb5</ComboBoxItem>
                        <ComboBoxItem>vb6</ComboBoxItem>
                    </ComboBox>

                    <ComboBox x:Name="ComboBox_ExtractTechnique" Header="ExtractTechnique" Width="200" Margin="5" IsEditable="True">
                        <ComboBoxItem>pointlist</ComboBoxItem>
                        <ComboBoxItem>trianglelist</ComboBoxItem>
                    </ComboBox>

                    <ComboBox x:Name="ComboBox_Category" Header="Category" Width="200" Margin="5" IsEditable="True">
                        <ComboBoxItem>Position</ComboBoxItem>
                        <ComboBoxItem>Texcoord</ComboBoxItem>
                        <ComboBoxItem>Blend</ComboBoxItem>
                    </ComboBox>

                    <ComboBox x:Name="ComboBox_DrawCategory" Header="DrawCategory" Width="200" Margin="5" IsEditable="True">
                        <ComboBoxItem>Position</ComboBoxItem>
                        <ComboBoxItem>Texcoord</ComboBoxItem>
                        <ComboBoxItem>Blend</ComboBoxItem>
                    </ComboBox>

                <NumberBox
                    x:Name="NumberBox_ByteWidth"
                    Margin="5"
                    Header="ByteWidth"
                    >
                    
                </NumberBox>

                    <MenuFlyoutSeparator></MenuFlyoutSeparator>

                    <Button 
                        Style="{StaticResource AccentButtonStyle}"
                        Margin="5"
                        x:Name="Button_AddNewD3D11ElementLine" 
                        Click="Button_AddNewD3D11ElementLine_Click" 
                        Content="新增数据类型行" >
                    </Button>

                    <Button
                        Margin="5"
                        x:Name="Button_AddNewD3D11ElementLineAfterChooseLine"
                        Click="Button_AddNewD3D11ElementLineAfterChooseLine_Click"
                        Content="在选定行后新增数据类型行">
                    </Button>

                    <MenuFlyoutSeparator></MenuFlyoutSeparator>

                    <Button
                        Margin="5"
                        x:Name="Button_ClearD3D11ElementLine"
                        Click="Button_ClearD3D11ElementLine_Click"
                        Content="清除所有数据类型行">
                    </Button>
                </StackPanel>

            </ScrollViewer>
         
        </Grid>

</Page>
